
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../intermediate/none/">
      
      
        <link rel="next" href="../3D%20Geological%20Model%20with%20Gempy/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>DrillHole Data Automation - Kenali_bUMI</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../extra/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#modul-automasi-pengolahan-database-pengeboran" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Kenali_bUMI" class="md-header__button md-logo" aria-label="Kenali_bUMI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kenali_bUMI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DrillHole Data Automation
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Kenali_bUMI" class="md-nav__button md-logo" aria-label="Kenali_bUMI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Kenali_bUMI
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/Membuat%20Topo%20dari%20Data%20Koordinat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Membuat Topo dari Data Koordinat
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Intermediate
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Intermediate
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intermediate/none/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Empty
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    DrillHole Data Automation
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    DrillHole Data Automation
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#modul-automasi-pengolahan-database-pengeboran" class="md-nav__link">
    <span class="md-ellipsis">
      Modul: Automasi pengolahan database pengeboran
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modul: Automasi pengolahan database pengeboran">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sekapur-sirih" class="md-nav__link">
    <span class="md-ellipsis">
      Sekapur Sirih
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#panduan-step-by-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Panduan Step by Steps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Panduan Step by Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#langkah-1-menyiapkan-environment-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Langkah 1: Menyiapkan Environment Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#langkah-2-buat-skrip-utama-data_updaterpy" class="md-nav__link">
    <span class="md-ellipsis">
      Langkah 2: Buat Skrip Utama (data_updater.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bagian-1-impor-dan-konfigurasi" class="md-nav__link">
    <span class="md-ellipsis">
      Bagian 1: Impor dan Konfigurasi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bagian-2-pemantauan-sistem-file-dengan-watchdog" class="md-nav__link">
    <span class="md-ellipsis">
      Bagian 2: Pemantauan Sistem File dengan Watchdog
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bagian-3-fungsi-pemrosesan-data" class="md-nav__link">
    <span class="md-ellipsis">
      Bagian 3: Fungsi Pemrosesan Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bagian-4-menampilakan-data-dengan-dashboard-sederhana-dengan-flask" class="md-nav__link">
    <span class="md-ellipsis">
      Bagian 4: Menampilakan data dengan dashboard sederhana dengan Flask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bagian-5-menjalankan-sistem" class="md-nav__link">
    <span class="md-ellipsis">
      Bagian 5: Menjalankan Sistem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#langkah-3-ujicoba-dan-penanganan-masalah" class="md-nav__link">
    <span class="md-ellipsis">
      Langkah 3: Ujicoba dan Penanganan Masalah
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#penanganan-kesalahan-rinci-dan-solusi" class="md-nav__link">
    <span class="md-ellipsis">
      Penanganan Kesalahan Rinci dan Solusi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kesimpulan" class="md-nav__link">
    <span class="md-ellipsis">
      Kesimpulan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kesimpulan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#peningkatan-potensial" class="md-nav__link">
    <span class="md-ellipsis">
      Peningkatan Potensial
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#referensi" class="md-nav__link">
    <span class="md-ellipsis">
      Referensi
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3D%20Geological%20Model%20with%20Gempy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3D Geological Model with Gempy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Geology
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Geology
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Geology Structure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Geology Structure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../geology/geology%20structure/none/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Empty
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Petrology
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Petrology
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../geology/petrology/none/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Empty
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Support by
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#modul-automasi-pengolahan-database-pengeboran" class="md-nav__link">
    <span class="md-ellipsis">
      Modul: Automasi pengolahan database pengeboran
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modul: Automasi pengolahan database pengeboran">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sekapur-sirih" class="md-nav__link">
    <span class="md-ellipsis">
      Sekapur Sirih
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#panduan-step-by-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Panduan Step by Steps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Panduan Step by Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#langkah-1-menyiapkan-environment-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Langkah 1: Menyiapkan Environment Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#langkah-2-buat-skrip-utama-data_updaterpy" class="md-nav__link">
    <span class="md-ellipsis">
      Langkah 2: Buat Skrip Utama (data_updater.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bagian-1-impor-dan-konfigurasi" class="md-nav__link">
    <span class="md-ellipsis">
      Bagian 1: Impor dan Konfigurasi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bagian-2-pemantauan-sistem-file-dengan-watchdog" class="md-nav__link">
    <span class="md-ellipsis">
      Bagian 2: Pemantauan Sistem File dengan Watchdog
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bagian-3-fungsi-pemrosesan-data" class="md-nav__link">
    <span class="md-ellipsis">
      Bagian 3: Fungsi Pemrosesan Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bagian-4-menampilakan-data-dengan-dashboard-sederhana-dengan-flask" class="md-nav__link">
    <span class="md-ellipsis">
      Bagian 4: Menampilakan data dengan dashboard sederhana dengan Flask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bagian-5-menjalankan-sistem" class="md-nav__link">
    <span class="md-ellipsis">
      Bagian 5: Menjalankan Sistem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#langkah-3-ujicoba-dan-penanganan-masalah" class="md-nav__link">
    <span class="md-ellipsis">
      Langkah 3: Ujicoba dan Penanganan Masalah
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#penanganan-kesalahan-rinci-dan-solusi" class="md-nav__link">
    <span class="md-ellipsis">
      Penanganan Kesalahan Rinci dan Solusi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kesimpulan" class="md-nav__link">
    <span class="md-ellipsis">
      Kesimpulan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kesimpulan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#peningkatan-potensial" class="md-nav__link">
    <span class="md-ellipsis">
      Peningkatan Potensial
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#referensi" class="md-nav__link">
    <span class="md-ellipsis">
      Referensi
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>DrillHole Data Automation</h1>

<h2 id="modul-automasi-pengolahan-database-pengeboran">Modul: Automasi pengolahan database pengeboran</h2>
<p><strong>Developed by:</strong> <a href="https://www.linkedin.com/in/faisal-amal-974004202">Hamba ALLAH</a></p>
<p><em>For further colaborations, feel free to reach me out with Hyperlink above</em></p>
<h3 id="sekapur-sirih"><strong>Sekapur Sirih</strong></h3>
<p>Modul ini diharapkan dapat membantu dalam pembuatan automasi database dengan meng-update data harian secara automatis (contoh kasus dalam modul ini menggunakan data pengeboran yang akan terus diupdate berdasarkan data titik bor yang finish). Semoga bermanfaat dan membawa kebaikan.</p>
<hr />
<h3 id="panduan-step-by-steps">Panduan Step by Steps</h3>
<h4 id="langkah-1-menyiapkan-environment-tools">Langkah 1: Menyiapkan Environment Tools</h4>
<p><strong>1. Install Python:</strong></p>
<ul>
<li>Unduh dan install Python 3.11 atau lebih baru dari <a href="https://www.python.org/downloads/">situs resmi Python</a>.</li>
<li>Saat instalasi, pastikan opsi “Tambahkan Python ke PATH” dicentang untuk akses baris perintah.</li>
<li>Verifikasi instalasi dengan membuka Command Prompt (Windows) atau Terminal (Mac/Linux) dan ketik <code>python --version</code>.</li>
</ul>
<p><strong>2. Buat Folder Proyek:</strong></p>
<ul>
<li>Buat folder bernama <code>DrillHole_Automation</code> di komputer Anda (misalnya, <code>C:\Users\NamaPenggunaAnda\DrillHole_Automation</code>).</li>
<li>Di dalamnya, buat subfolder <code>Daily_Data</code> untuk file data harian yang akan ditambahkan ke database.</li>
</ul>
<p><strong>3. Install Library yang Diperlukan:</strong></p>
<ul>
<li>Buka Command Prompt, navigasikan ke <code>DrillHole_Automation</code> (misalnya, <code>cd C:\Users\NamaPenggunaAnda\DrillHole_Automation</code>), dan jalankan perintah dibawah:
     <div class="highlight"><pre><span></span><code>pip install flask watchdog openpyxl pandas matplotlib
</code></pre></div></li>
<li>Perintah diatas menginstal library Flask (server web), Watchdog (pemantauan file), OpenPyXL (penanganan Excel), Pandas (manipulasi data), dan Matplotlib (visualisasi).</li>
</ul>
<p><strong>4. Siapkan File database Anda:</strong></p>
<ul>
<li>Siapkan format database, e.g: <code>drilling_database.xlsx</code> dalam folder <code>DrillHole_Automation</code> dengan format disesuaikan dengan format database yang dibutuhkan (misalnya, <code>Date Logging</code>, <code>Hole ID</code>, <code>From</code>, dll.).</li>
<li>Pastikan file dapat diedit dan tidak dibuka di Excel selama eksekusi skrip.</li>
</ul>
<p><strong>5. Siapkan File Data Harian:</strong></p>
<ul>
<li>Letakkan file Excel harian sampel (misalnya, <code>daily-data.xlsx</code>) di <code>Daily_Data</code>. File ini harus mengikuti format konsisten dengan metadata (e.g: Nama titi bor sel B2, Tanggal di sel J3).</li>
</ul>
<hr />
<h4 id="langkah-2-buat-skrip-utama-data_updaterpy">Langkah 2: Buat Skrip Utama (<code>data_updater.py</code>)</h4>
<p>Buat file bernama <code>data_updater.py</code> di <code>DrillHole_Automation</code>. Script kode pada bagian ini akan kami bagi menjadi beberapa bagian yang akan membantu memudahkan dalam memahami format kode. </p>
<h4 id="bagian-1-impor-dan-konfigurasi">Bagian 1: Impor dan Konfigurasi</h4>
<p><strong>Tujuan:</strong> Menyiapkan library yang diperlukan.</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>  <span class="c1"># Gunakan backend non-GUI untuk Matplotlib untuk menghindari masalah threading</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">watchdog.observers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Observer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">watchdog.events</span><span class="w"> </span><span class="kn">import</span> <span class="n">FileSystemEventHandler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">render_template_string</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">openpyxl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>

<span class="c1"># Siapkan logging untuk debugging dan pelacakan</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Konfigurasi</span>
<span class="n">daily_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Daily_Data&#39;</span>
<span class="n">database_file</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\NamaPenggunaAnda\DrillHole_Automation\drilling_database.xlsx&#39;</span>
</code></pre></div>
<strong>Penjelasan:</strong></p>
<ul>
<li><code>matplotlib.use('Agg')</code> mencegah error terkait GUI (misalnya, konflik dengan Tkinter) dengan menggunakan backend non-interaktif.</li>
<li>Flask digunakan untuk menampilkan data bebasis dashboard, pemantauan file (Watchdog), manipulasi Excel (OpenPyXL), analisis data (Pandas), dan visualisasi (Matplotlib).</li>
<li>Logging melacak operasi untuk debugging.</li>
<li><code>daily_folder</code> dan <code>database_file</code> menentukan jalur file (sesuaikan <code>NamaPenggunaAnda</code> dengan nama pengguna Windows Anda atau gunakan <code>os.path.expanduser</code> untuk kompatibilitas lintas platform, misalnya, <code>os.path.expanduser('~') + '/DrillHole_Automation/drilling_database.xlsx'</code>).</li>
</ul>
<p><strong>Potensi eror:</strong></p>
<p><strong>Masalah penempatan folder:</strong> Jika jalur <code>daily_folder</code> atau <code>database_file</code> tidak sesuai, Anda akan mendapatkan <code>FileNotFoundError</code>. Verifikasi jalur di File Explorer dan sesuaikan.</p>
<p><strong>Error Instalasi Library:</strong> Potensi <code>pip install</code> gagal, pastikan ada akses internet atau periksa kompatibilitas versi Python.</p>
<hr />
<h4 id="bagian-2-pemantauan-sistem-file-dengan-watchdog">Bagian 2: Pemantauan Sistem File dengan Watchdog</h4>
<p><strong>Tujuan:</strong> Mendeteksi folder <code>Daily_Data</code> untuk mendeteksi file Excel baru dan melakukan pemrosesan.</p>
<p><div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Watcher</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observer</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">event_handler</span> <span class="o">=</span> <span class="n">Handler</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observer</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">event_handler</span><span class="p">,</span> <span class="n">daily_folder</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">observer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observer</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Handler</span><span class="p">(</span><span class="n">FileSystemEventHandler</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_created</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">is_directory</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.xls&#39;</span><span class="p">)</span> <span class="n">atau</span> <span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File baru terdeteksi: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">process_new_file</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Berhasil memproses file: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error memproses file </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<strong>Penjelasan:</strong></p>
<ul>
<li><code>Watcher</code> membuat <code>Observer</code> untuk memantau <code>daily_folder</code> secara continue.</li>
<li><code>Handler</code> memantau pembuatan file, memfilter file <code>.xls</code> atau <code>.xlsx</code>, dan menjalankan <code>process_new_file</code> untuk mengolah file baru.</li>
<li><code>time.sleep(1)</code> mencegah overload CPU; <code>KeyboardInterrupt</code> menutup sistem ketika mengalami overload or stuck.</li>
</ul>
<p><strong>Kemungkinan Eror:</strong></p>
<p><strong>Izin Ditolak:</strong> Jika <code>Daily_Data</code> tidak memiliki izin baca/tulis, <code>Watchdog</code> gagal. Periksa izin folder di Windows Explorer.</p>
<p><strong>Penguncian File:</strong> Jika file dibuka di Excel, <code>Watchdog</code> mungkin memicu sebelum file sepenuhnya diedit, menyebabkan <code>PermissionError</code>. Tambahkan <code>time.sleep(2)</code> di <code>process_new_file</code> untuk menunda pemrosesan.</p>
<hr />
<h4 id="bagian-3-fungsi-pemrosesan-data">Bagian 3: Fungsi Pemrosesan Data</h4>
<p><strong>Tujuan:</strong> Menganalisis, memindahkan, dan memperbarui data harian ke dalam database.</p>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_new_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Pastikan file sepenuhnya ditulis</span>
    <span class="n">transformed_data</span> <span class="o">=</span> <span class="n">transform_data</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">append_to_database</span><span class="p">(</span><span class="n">transformed_data</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">transform_data</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">wb</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">data_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>

        <span class="n">raw_hole_id</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">[</span><span class="s1">&#39;B2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">raw_date_logging</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">[</span><span class="s1">&#39;J3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Metadata mentah dari </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span><span class="si">}</span><span class="s2"> - B2: </span><span class="si">{</span><span class="n">raw_hole_id</span><span class="si">}</span><span class="s2">, J3: </span><span class="si">{</span><span class="n">raw_date_logging</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">hole_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">raw_hole_id</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">raw_hole_id</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">date_logging</span> <span class="o">=</span> <span class="n">raw_date_logging</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date_logging</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
            <span class="n">date_logging</span> <span class="o">=</span> <span class="n">date_logging</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date_logging</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">date_logging</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date_logging</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">date_logging</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">hole_id</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">date_logging</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing or invalid Hole ID (</span><span class="si">{</span><span class="n">hole_id</span><span class="si">}</span><span class="s2">) or Date Logging (</span><span class="si">{</span><span class="n">date_logging</span><span class="si">}</span><span class="s2">) in metadata&quot;</span><span class="p">)</span>

        <span class="n">daily_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="s1">&#39;B:V&#39;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kolom di </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">daily_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Data kolom disesuaikan dengan format database yang dibuat atau dimiliki.</span>
        <span class="n">required_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FROM&#39;</span><span class="p">,</span> <span class="s1">&#39;TO&#39;</span><span class="p">,</span> <span class="s1">&#39;INTERVAL (M)&#39;</span><span class="p">,</span> <span class="s1">&#39;ACT CORE (M)&#39;</span><span class="p">,</span> <span class="s1">&#39;RECOVERY (%)&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;GENERAL LITHOLOGY&#39;</span><span class="p">,</span> <span class="s1">&#39;SUB GEN LITHOLOGY&#39;</span><span class="p">,</span> <span class="s1">&#39;ROCK CODE&#39;</span><span class="p">,</span> <span class="s1">&#39;GRAIN SIZE&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;WEATHERING&#39;</span><span class="p">,</span> <span class="s1">&#39;COLOUR&#39;</span><span class="p">,</span> <span class="s1">&#39;PRIMARY.1&#39;</span><span class="p">,</span> <span class="s1">&#39;SECONDARY.1&#39;</span><span class="p">,</span> <span class="s1">&#39;TERTIARY&#39;</span><span class="p">]</span>
        <span class="n">missing_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">required_columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">daily_data</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">missing_columns</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kolom yang diharapkan hilang: </span><span class="si">{</span><span class="n">missing_columns</span><span class="si">}</span><span class="s2">. Kembali ke indeks.&quot;</span><span class="p">)</span>
            <span class="n">daily_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="s1">&#39;B:V&#39;</span><span class="p">)</span>
            <span class="n">transformed_rows</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">daily_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="k">continue</span>
                <span class="n">transformed_row</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;Date Logging&#39;</span><span class="p">:</span> <span class="n">date_logging</span><span class="p">,</span>
                    <span class="s1">&#39;Hole ID&#39;</span><span class="p">:</span> <span class="n">hole_id</span><span class="p">,</span>
                    <span class="s1">&#39;From&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s1">&#39;To&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s1">&#39;Length&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="s1">&#39;Actual Core&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                    <span class="s1">&#39;Recovery pecentage&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="k">else</span> <span class="mf">1.0</span><span class="p">,</span>
                    <span class="s1">&#39;Material Code&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Layer Code&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Rock Code&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Grain&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Weath&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s1">&#39;Colour&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">13</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">13</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Minerals Pri&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">16</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">16</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Minerals Sec&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">17</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">17</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Minerals Ter&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Bolder leght (m)&#39;</span><span class="p">:</span> <span class="kc">None</span>
                <span class="p">}</span>
                <span class="n">transformed_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transformed_row</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">transformed_rows</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">daily_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;FROM&#39;</span><span class="p">]):</span>
                    <span class="k">continue</span>
                <span class="n">transformed_row</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;Date Logging&#39;</span><span class="p">:</span> <span class="n">date_logging</span><span class="p">,</span>
                    <span class="s1">&#39;Hole ID&#39;</span><span class="p">:</span> <span class="n">hole_id</span><span class="p">,</span>
                    <span class="s1">&#39;From&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;FROM&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;To&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;TO&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;Length&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;INTERVAL (M)&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;Actual Core&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ACT CORE (M)&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;Recovery pecentage&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;RECOVERY (%)&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;RECOVERY (%)&#39;</span><span class="p">])</span> <span class="k">else</span> <span class="mf">1.0</span><span class="p">,</span>
                    <span class="s1">&#39;Material Code&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;GENERAL LITHOLOGY&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;GENERAL LITHOLOGY&#39;</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Layer Code&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SUB GEN LITHOLOGY&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SUB GEN LITHOLOGY&#39;</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Rock Code&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ROCK CODE&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ROCK CODE&#39;</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Grain&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;GRAIN SIZE&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;GRAIN SIZE&#39;</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Weath&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WEATHERING&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;WEATHERING&#39;</span><span class="p">])</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s1">&#39;Colour&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;COLOUR&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;COLOUR&#39;</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Minerals Pri&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;PRIMARY.1&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;PRIMARY.1&#39;</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Minerals Sec&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SECONDARY.1&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SECONDARY.1&#39;</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Minerals Ter&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;TERTIARY&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;TERTIARY&#39;</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Bolder leght (m)&#39;</span><span class="p">:</span> <span class="kc">None</span>
                <span class="p">}</span>
                <span class="n">transformed_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transformed_row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">transformed_rows</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error di transform_data: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>

<span class="k">def</span><span class="w"> </span><span class="nf">append_to_database</span><span class="p">(</span><span class="n">transformed_rows</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">db_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">database_file</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mencoba memperbarui database di: </span><span class="si">{</span><span class="n">db_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">wb</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
        <span class="n">last_row</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">max_row</span>

        <span class="k">if</span> <span class="n">last_row</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Date Logging&#39;</span><span class="p">,</span> <span class="s1">&#39;Hole ID&#39;</span><span class="p">,</span> <span class="s1">&#39;From&#39;</span><span class="p">,</span> <span class="s1">&#39;To&#39;</span><span class="p">,</span> <span class="s1">&#39;Length&#39;</span><span class="p">,</span> <span class="s1">&#39;Actual Core&#39;</span><span class="p">,</span> <span class="s1">&#39;Recovery pecentage&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;Material Code&#39;</span><span class="p">,</span> <span class="s1">&#39;Layer Code&#39;</span><span class="p">,</span> <span class="s1">&#39;Rock Code&#39;</span><span class="p">,</span> <span class="s1">&#39;Grain&#39;</span><span class="p">,</span> <span class="s1">&#39;Weath&#39;</span><span class="p">,</span> <span class="s1">&#39;Colour&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;Minerals Pri&#39;</span><span class="p">,</span> <span class="s1">&#39;Minerals Sec&#39;</span><span class="p">,</span> <span class="s1">&#39;Minerals Ter&#39;</span><span class="p">,</span> <span class="s1">&#39;Bolder leght (m)&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">header</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">header</span>
            <span class="n">last_row</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="n">transformed_rows</span><span class="p">:</span>
            <span class="n">last_row</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Date Logging&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Hole ID&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;From&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Actual Core&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Recovery pecentage&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Material Code&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Layer Code&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Rock Code&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Grain&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Weath&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Colour&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Minerals Pri&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Minerals Sec&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Minerals Ter&#39;</span><span class="p">]</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">last_row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="s1">&#39;Bolder leght (m)&#39;</span><span class="p">]</span>

        <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Berhasil menambahkan </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">transformed_rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> baris ke </span><span class="si">{</span><span class="n">db_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error menambahkan ke database: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div>
<strong>Penjelasan:</strong></p>
<ul>
<li><code>process_new_file</code>: Mengkoordini pengolahan data dan memastikan ketersediaan file.</li>
<li><code>transform_data</code>: Membaca metadata (ID Lubang, Tanggal), memvalidasinya, dan mentransformasi data harian ke format database, menangani ketidaksesuaian header dengan indeks sebagai cadangan.</li>
<li><code>append_to_database</code>: Memperbarui <code>drilling_database.xlsx</code>, menambahkan header jika diperlukan, memastikan konsistensi data.</li>
</ul>
<p><strong>Kemungkinan Eror:</strong></p>
<p><strong>Error Metadata:</strong> Jika cell excel <code>B2</code> atau <code>J3</code> kosong, gunakan log untuk debugging dan buat ulang file jika rusak.</p>
<p><strong>Ketidaksesuaian Kolom:</strong> Jika header berbeda, log akan menunjukkan nama kolom; sesuaikan <code>transform_data</code> untuk indeks atau header.</p>
<p><strong>Izin File:</strong> Pastikan akses tulis ke <code>drilling_database.xlsx</code>, periksa melalui properti Windows Explorer.</p>
<hr />
<h4 id="bagian-4-menampilakan-data-dengan-dashboard-sederhana-dengan-flask">Bagian 4: Menampilakan data dengan dashboard sederhana dengan <code>Flask</code></h4>
<p><strong>Tujuan:</strong> Menyediakan dashboard di internal komputer untuk visualisasi dan pembaruan manual.</p>
<p><div class="highlight"><pre><span></span><code><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">load_database</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">database_file</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_recovery_plot</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">depth_avg</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;From&#39;</span><span class="p">)[</span><span class="s1">&#39;Recovery pecentage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">depth_avg</span><span class="p">[</span><span class="s1">&#39;From&#39;</span><span class="p">],</span> <span class="n">depth_avg</span><span class="p">[</span><span class="s1">&#39;Recovery pecentage&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;biru&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Persentase Pemulihan Rata-rata vs. Kedalaman Rata-rata&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Kedalaman Rata-rata (m) - Dari&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Persentase Pemulihan Rata-rata&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_material_distribution_plot</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">material_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Material Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">material_counts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;ungu&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribusi Kode Material&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Kode Material&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Jumlah&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

<span class="n">DASHBOARD_TEMPLATE</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;!DOCTYPE html&gt;</span>
<span class="s2">&lt;html&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;title&gt;Dashboard Analitik DrillHole&lt;/title&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">        body { font-family: Arial, sans-serif; margin: 0; background-color: #f5f7fa; color: #333; }</span>
<span class="s2">        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }</span>
<span class="s2">        .sidebar { width: 200px; float: left; background-color: #e9ecef; padding: 20px; height: 100vh; position: fixed; }</span>
<span class="s2">        .content { margin-left: 220px; }</span>
<span class="s2">        h1 { text-align: center; color: #2c3e50; margin-bottom: 20px; }</span>
<span class="s2">        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 20px; }</span>
<span class="s2">        .stat-card { background-color: white; border-radius: 8px; padding: 15px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }</span>
<span class="s2">        .stat-card h3 { margin: 0 0 5px 0; font-size: 14px; color: #7f8c8d; }</span>
<span class="s2">        .stat-card p { margin: 0; font-size: 18px; color: #2c3e50; }</span>
<span class="s2">        .plot-section { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }</span>
<span class="s2">        .plot { text-align: center; }</span>
<span class="s2">        img { max-width: 100%; height: auto; }</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;</span>
<span class="s2">    &lt;div class=&quot;sidebar&quot;&gt;</span>
<span class="s2">        &lt;h2&gt;Navigasi&lt;/h2&gt;</span>
<span class="s2">        &lt;ul style=&quot;list-style-type: none; padding: 0;&quot;&gt;</span>
<span class="s2">            &lt;li&gt;&lt;a href=&quot;/&quot; style=&quot;color: #2c3e50; text-decoration: none;&quot;&gt;Dashboard&lt;/a&gt;&lt;/li&gt;</span>
<span class="s2">            &lt;li&gt;&lt;a href=&quot;/update&quot; style=&quot;color: #2c3e50; text-decoration: none;&quot;&gt;Perbarui Data&lt;/a&gt;&lt;/li&gt;</span>
<span class="s2">            &lt;li&gt;&lt;a href=&quot;/database-status&quot; style=&quot;color: #2c3e50; text-decoration: none;&quot;&gt;Status database&lt;/a&gt;&lt;/li&gt;</span>
<span class="s2">        &lt;/ul&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    &lt;div class=&quot;content&quot;&gt;</span>
<span class="s2">        &lt;div class=&quot;container&quot;&gt;</span>
<span class="s2">            &lt;h1&gt;Dashboard Analitik DrillHole&lt;/h1&gt;</span>
<span class="s2">            &lt;div class=&quot;stats-grid&quot;&gt;</span>
<span class="s2">                &lt;div class=&quot;stat-card&quot;&gt;</span>
<span class="s2">                    &lt;h3&gt;Total Lubang Pengeboran&lt;/h3&gt;</span>
<span class="s2">                    &lt;p&gt;{{ total_holes }}&lt;/p&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">                &lt;div class=&quot;stat-card&quot;&gt;</span>
<span class="s2">                    &lt;h3&gt;Kedalaman Rata-rata&lt;/h3&gt;</span>
<span class="s2">                    &lt;p&gt;{{ avg_depth|round(2) }} m&lt;/p&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">                &lt;div class=&quot;stat-card&quot;&gt;</span>
<span class="s2">                    &lt;h3&gt;Kedalaman Terdalam&lt;/h3&gt;</span>
<span class="s2">                    &lt;p&gt;{{ deepest_depth|round(2) }} m&lt;/p&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">                &lt;div class=&quot;stat-card&quot;&gt;</span>
<span class="s2">                    &lt;h3&gt;Kedalaman Terpendek&lt;/h3&gt;</span>
<span class="s2">                    &lt;p&gt;{{ shallowest_depth|round(2) }} m&lt;/p&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">            &lt;div class=&quot;plot-section&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Persentase Pemulihan Rata-rata vs. Kedalaman Rata-rata&lt;/h2&gt;</span>
<span class="s2">                &lt;div class=&quot;plot&quot;&gt;</span>
<span class="s2">                    {</span><span class="si">% i</span><span class="s2">f recovery_plot %}</span>
<span class="s2">                        &lt;img src=&quot;data:image/png;base64,{{ recovery_plot }}&quot; alt=&quot;Plot Pemulihan&quot;&gt;</span>
<span class="s2">                    {</span><span class="si">% e</span><span class="s2">lse %}</span>
<span class="s2">                        &lt;p&gt;Tidak ada data yang tersedia.&lt;/p&gt;</span>
<span class="s2">                    {</span><span class="si">% e</span><span class="s2">ndif %}</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">            &lt;div class=&quot;plot-section&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Distribusi Kode Material&lt;/h2&gt;</span>
<span class="s2">                &lt;div class=&quot;plot&quot;&gt;</span>
<span class="s2">                    &lt;img src=&quot;data:image/png;base64,{{ material_plot }}&quot; alt=&quot;Distribusi Material&quot;&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dashboard</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">load_database</span><span class="p">()</span>
        <span class="n">total_holes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Hole ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">avg_depth</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">deepest_depth</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">shallowest_depth</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;From&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">recovery_plot</span> <span class="o">=</span> <span class="n">generate_recovery_plot</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="n">material_plot</span> <span class="o">=</span> <span class="n">generate_material_distribution_plot</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="n">DASHBOARD_TEMPLATE</span><span class="p">,</span> <span class="n">total_holes</span><span class="o">=</span><span class="n">total_holes</span><span class="p">,</span> <span class="n">avg_depth</span><span class="o">=</span><span class="n">avg_depth</span><span class="p">,</span>
                                     <span class="n">deepest_depth</span><span class="o">=</span><span class="n">deepest_depth</span><span class="p">,</span> <span class="n">shallowest_depth</span><span class="o">=</span><span class="n">shallowest_depth</span><span class="p">,</span>
                                     <span class="n">recovery_plot</span><span class="o">=</span><span class="n">recovery_plot</span><span class="p">,</span> <span class="n">material_plot</span><span class="o">=</span><span class="n">material_plot</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error merender dashboard: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">500</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/update&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">trigger_update</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">processed_files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">scandir</span><span class="p">(</span><span class="n">daily_folder</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.xls&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">)):</span>
                <span class="n">process_new_file</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
                <span class="n">processed_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;processed_files&#39;</span><span class="p">:</span> <span class="n">processed_files</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Pembaruan manual dipicu&#39;</span><span class="p">}</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)},</span> <span class="mi">500</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/database-status&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">database_status</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">wb</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">database_file</span><span class="p">)</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;last_row&#39;</span><span class="p">:</span> <span class="n">sheet</span><span class="o">.</span><span class="n">max_row</span><span class="p">},</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)},</span> <span class="mi">500</span>
</code></pre></div>
<strong>Penjelasan:</strong></p>
<ul>
<li><code>load_database</code>: Memuat database untuk analisis.</li>
<li><code>generate_recovery_plot</code>, <code>generate_material_distribution_plot</code>: Membuat visualisasi, dideskripsikan sebagai base64 untuk dashboard.</li>
<li><code>DASHBOARD_TEMPLATE</code>: HTML dengan CSS untuk menampilkan dashboard, meliputi statistik dan plot.</li>
<li>Rute menangani tampilan dashboard, pembaruan manual, dan pemeriksaan status database.</li>
</ul>
<p><strong>Kemungkinan Eror:</strong></p>
<p><strong>Masalah Backend Matplotlib:</strong> Jika <code>matplotlib.use('Agg')</code> dilewatkan, expect error threading. Pastikan ada di awal skrip.</p>
<p><strong>Error Memuat database:</strong> Jika <code>drilling_database.xlsx</code> hilang atau salah format, <code>pd.read_excel</code> gagal. Verifikasi keberadaan dan format file.</p>
<p><strong>Error Rute Flask:</strong> Pastikan metode HTTP benar; sesuaikan jika terjadi error 405, seperti yang terlihat dengan <code>/update</code>.</p>
<hr />
<h4 id="bagian-5-menjalankan-sistem">Bagian 5: Menjalankan Sistem</h4>
<p><strong>Tujuan:</strong> Jalankan skrip untuk memantau dan memperbarui data secara terus-menerus.</p>
<p><div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">watcher_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">Watcher</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">())</span>
    <span class="n">watcher_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">watcher_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</code></pre></div>
<strong>Penjelasan:</strong></p>
<ul>
<li>Menjalankan <code>Watcher</code> untuk pemantauan file pada folder yang telah ditentukan sebelumnya.</li>
<li>Meluncurkan Flask di <code>localhost:5000</code>, dapat diakses melalui browser untuk dashboard.</li>
</ul>
<p><strong>Kemungkinan Eror:</strong>
<strong>Konflik Port:</strong> Jika anda sedang menjalankan 5000 sebagai lokal host untuk projek lain maka Flask tidak dapat mengunakan host tersebut. Ubah ke <code>app.run(host='127.0.0.1', port=5001)</code> atau hapus poject yang bersangkutan.</p>
<p><strong>Masalah Threading:</strong> Jika <code>Watcher</code> atau Flask crash, periksa log untuk pengecualian, memastikan izin dan akses file yang tepat.</p>
<hr />
<h4 id="langkah-3-ujicoba-dan-penanganan-masalah">Langkah 3: Ujicoba dan Penanganan Masalah</h4>
<ol>
<li>
<p><strong>Jalankan Skrip:</strong></p>
<ul>
<li>Buka Command Prompt di <code>DrillHole_Automation</code>, ketik <code>python data_updater.py</code>, dan tekan Enter.</li>
<li>Periksa log untuk konfirmasi (misalnya, <code>File baru terdeteksi</code>).</li>
</ul>
</li>
<li>
<p><strong>Tambahkan File Uji:</strong></p>
<ul>
<li>Salin <code>daily-data.xlsx</code> ke <code>Daily_Data</code> dan verifikasi pembaruan database, memeriksa log untuk keberhasilan atau error.</li>
</ul>
</li>
<li>
<p><strong>Akses Dashboard:</strong></p>
<ul>
<li>Buka browser di <code>http://127.0.0.1:5000</code> untuk melihat statistik dan plot.</li>
<li>Gunakan tautan sidebar untuk menguji <code>/update</code> dan <code>/database-status</code>.</li>
</ul>
</li>
<li>
<p><strong>Solusi:</strong></p>
<ul>
<li><strong>Masalah Metadata:</strong> Jika <code>Missing or invalid metadata</code>, buka <code>daily-data.xlsx</code>, pastikan <code>B2</code> dan <code>J3</code> memiliki data, dan log nilai mentah untuk debugging.</li>
<li><strong>Ketidaksesuaian Kolom:</strong> Jika <code>KeyError</code>, log <code>daily_data.columns</code> dan sesuaikan <code>transform_data</code> untuk indeks atau header.</li>
<li><strong>Error Matplotlib:</strong> Jika <code>RuntimeError</code>, pastikan <code>matplotlib.use('Agg')</code> ada di awal skrip.</li>
<li><strong>Error 405:</strong> Jika <code>/update</code> gagal, verifikasi eror tersebut dengan melihat GET di dashboard.</li>
</ul>
</li>
</ol>
<hr />
<h3 id="penanganan-kesalahan-rinci-dan-solusi">Penanganan Kesalahan Rinci dan Solusi</h3>
<table>
<thead>
<tr>
<th><strong>Kesalahan</strong></th>
<th><strong>Penyebab</strong></th>
<th><strong>Solusi</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>FileNotFoundError</code> untuk <code>daily_folder</code></td>
<td>Jalur folder atau file salah</td>
<td>Verifikasi jalur, gunakan <code>os.path.exists()</code> untuk memeriksa</td>
</tr>
<tr>
<td><code>PermissionError</code> untuk akses file</td>
<td>File terkunci atau tidak ada izin</td>
<td>Tutup Excel, periksa izin Windows</td>
</tr>
<tr>
<td><code>KeyError: 'FROM'</code></td>
<td>Header hilang atau salah nama di file harian</td>
<td>Log kolom, gunakan indeks, pastikan format file</td>
</tr>
<tr>
<td><code>ValueError: Missing or invalid metadata</code></td>
<td>Sel <code>B2</code> atau <code>J3</code> kosong atau salah format</td>
<td>Buka file, verifikasi data, log nilai mentah, buat ulang</td>
</tr>
<tr>
<td><code>RuntimeError: main thread not in main loop</code></td>
<td>Konflik backend Matplotlib Tkinter</td>
<td>Gunakan <code>matplotlib.use('Agg')</code> di awal skrip</td>
</tr>
<tr>
<td><code>405 Method Not Allowed</code> untuk <code>/update</code></td>
<td>Permintaan GET ke rute POST-only</td>
<td>Tambah <code>methods=['GET', 'POST']</code> ke rute <code>/update</code></td>
</tr>
<tr>
<td><code>Port Already in Use</code> untuk Flask</td>
<td>Port 5000 sedang digunakan</td>
<td>Ubah ke port lain (misalnya, 5001)</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="kesimpulan">Kesimpulan</h3>
<p>Panduan ini diharapkan membantu Anda membuat, menguji, dan memelihara sistem automasi data pengeboran di lokal komputer, menangani kesalahan melalui logging dan penyesuaian dari format data harian ke format database. Sistem ini mengotomatisasi pembaruan, menyediakan dashboard untuk memantau data, dan beroperasi secara offline, ideal untuk lingkungan kerja lapangan yang terkendala akses internet.</p>
<h4 id="peningkatan-potensial">Peningkatan Potensial</h4>
<ul>
<li>Tambahkan validasi data untuk penanganan error yang lebih kuat.</li>
<li>Gunakan Plotly untuk visualisasi interaktif di dashboard.</li>
<li>Implementasikan cadangan terjadwal untuk <code>drilling_database.xlsx</code>.</li>
</ul>
<h4 id="referensi">Referensi</h4>
<ul>
<li><a href="https://flask.palletsprojects.com/en/2.0.x/">Dokumentasi Resmi Flask</a></li>
<li><a href="https://pythonhosted.org/watchdog/">Library Watchdog Python</a></li>
<li><a href="https://openpyxl.readthedocs.io/en/stable/">Dokumentasi OpenPyXL</a></li>
<li><a href="https://pandas.pydata.org/docs/">Dokumentasi Pandas</a></li>
<li><a href="https://matplotlib.org/stable/contents.html">Dokumentasi Matplotlib</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="footer-left">
        <div class="footer-general">
          <p>For general inquiries or support, feel free to contact us.</p>
        </div>
        <div class="footer-social">
          <a href="https://github.com/FaisalAmal" target="_blank">
            <span class="twemoji github">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
            </span>
            <span class="label">GitHub</span>
          </a>
          <a href="mailto:your.email@example.com">
            <span class="twemoji email">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0z"/></svg>
            </span>
            <span class="label">Email</span>
          </a>
          <a href="https://linkedin.com/in/faisal-amal-974004202" target="_blank">
            <span class="twemoji linkedin">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
            </span>
            <span class="label">LinkedIn</span>
          </a>
        </div>
      </div>
      <div class="footer-right">
        <div class="footer-copyright">
          © 2025 GeoPython Learn | Powered by MkDocs & Material for MkDocs
        </div>
      </div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "search.suggest"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>